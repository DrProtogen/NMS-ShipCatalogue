<!DOCTYPE html>
<html>

<head>
    <title>NMS Ship Creator</title>
    <style>
        body {
            background-color: #131313;
            margin: auto;
            font-family: sans-serif;
            font-size: 14px;
            color: rgb(255, 255, 255);
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #494949;
            height: 3rem;
            padding: 0.5rem 1rem;
            margin: 0;
            border-bottom: 2px solid #868686;
            font-family: sans-serif;
            font-size: 28px;
            font-weight: 400;
            color: #f7f7f7;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            text-shadow: 1px 1px 1px #acacac, 1px 1px 5px #858585, 1px 1px 15px #333333, 1px 1px 30px #000000;
            line-height: 31px;
        }



        .toptext {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 3rem;
            padding: 0.5rem 1rem;
            margin: 0;
            font-family: sans-serif;
            font-size: 28px;
            font-weight: 400;
            color: #f7f7f7;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            text-shadow: 1px 1px 1px #acacac, 1px 1px 5px #858585, 1px 1px 15px #333333, 1px 1px 30px #000000;
            line-height: 31px;
        }

        .DropshipParts img,
        .ExplorerParts img,
        .ShuttleParts img,
        .RoyalParts img,
        .BioshipParts img,
        .SolarParts img,
        .SentinelParts img {
            position: absolute;
            max-width: 100%;
            max-height: 100%;
            width: auto;
            top: 150px;
            pointer-events: none;
        }

        .FighterParts {
            position: absolute;
            max-height: 70%;
            width: auto;
            top: 150px;
            left: 30%;
            pointer-events: none;
        }

        .DropshipParts,
        .ExplorerParts,
        .ShuttleParts,
        .RoyalParts,
        .BioshipParts,
        .SolarParts,
        .SentinelParts {
            position: relative;
            min-height: 362px;
            margin: 0 auto;
            width: 580px;
            user-select: none;
        }

        .DropshipParts img,
        .BioshipParts img {
            margin-left: 15%;
        }

        .ExplorerParts img {
            margin-left: 25%;
            margin-top: 10%;
        }

        .ShuttleParts img,
        .SolarParts img,
        .SentinelParts img {
            margin-left: 10%;
        }

        .shiptype {
            position: absolute;
            top: 85%;
            left: 50%;
            transform: translateX(-50%);
            width: 250px;
            height: 50px;
        }


        .btn {
            border: 2px solid 1px 1px 1px #acacac, 1px 1px 5px #858585, 1px 1px 15px #333333, 1px 1px 30px #000000;
            background-color: #494949;
            color: black;
            padding: 14px 28px;
            font-size: 16px;
            cursor: pointer;
            width: auto !important;
            height: auto !important;
            position: absolute !important;
            top: 50% !important;
            left: 50% !important;
            transform: translate(550%, 0%) !important;
            transition: all 0.3s ease-in-out !important;
        }

        .next {
            border-color: 2px solid 1px 1px 1px #acacac, 1px 1px 5px #858585, 1px 1px 15px #333333, 1px 1px 30px #000000;
            color: rgb(138, 138, 138);
        }

        .next:hover {
            background-color: #979797;
            color: rgb(189, 189, 189);
        }

        select {
            background-color: #494949;
            color: rgb(189, 189, 189);
            margin: 5px;
        }

        .parts-container {
            display: flex;
            justify-content: center;
            position: absolute;
            top: 85%;
            left: 50%;
            transform: translateX(-50%);
        }

        .container2 {
            position: absolute;
            bottom: 15%;
            /* Align to the bottom */
            left: 50%;
            /* Center horizontally */
            transform: translateX(-50%);
            /* Adjust for centering */
            width: max-content;
            /* Ensure width fits content */
        }

        .container3 {
            position: absolute;
            bottom: 15%;
            /* Align to the bottom */
            left: 77%;
            /* Center horizontally */
            transform: translateX(-50%);
            /* Adjust for centering */
            width: max-content;
            /* Ensure width fits content */
        }

        .container1 {
            position: absolute;
            bottom: 15%;
            /* Align to the bottom */
            left: 23%;
            /* Center horizontally */
            transform: translateX(-50%);
            /* Adjust for centering */
            width: max-content;
            /* Ensure width fits content */
        }

        .text {
            position: absolute;
            top: -25px;
            /* Position above the grid */
            left: 50%;
            transform: translateX(-50%);
            font-size: 16px;
            font-family: Arial, sans-serif;
            color: #ffffff;




        }

        .grid {
            display: grid;
            grid-template-columns: repeat(10, 30px);
            grid-template-rows: repeat(2, 20px);
            gap: 5px;

        }



        .square {
            width: 30px;
            height: 20px;
            cursor: pointer;
            border: 1px solid #000;
        }

        /* Add a style for the selected square */
        .square.selected {
            border: 2px solid yellow;
            /* Highlight the selected square */
            box-shadow: 0 0 10px yellow;
        }

        .selected-parts{
            position: absolute; 
            top: 20%; 
            left: 5%; 

            font-size: 16px; 
            display: none;




            font-family: sans-serif;

            font-weight: 400;
            color: #f7f7f7;
            letter-spacing: 0.1em;
            text-shadow: 1px 1px 1px #acacac, 1px 1px 5px #858585, 1px 1px 15px #333333, 1px 1px 30px #000000;
            line-height: 31px;
        }
    </style>
</head>

<body>
    <h1 class="header">No Man's Sky - Ship Creator</h1>
    <h1 class="toptext">Select a ship type</h1>

    <img class="FighterParts" src="images/BaseFighter.png">

    <select class="shiptype" name="type" id="type">
        <option value="FIGHTER">Fighter</option>
        <!--<option value="DROPSHIP">Hauler</option>
        <option value="EXPLORER">Explorer</option>
        <option value="SHUTTLE">Shuttle</option>
        <option value="ROYAL">Royal/Exotic/Squid</option>
        <option value="BIOSHIP">Living</option>
        <option value="SOLAR">Solar</option>
        <option value="SENTINEL">Sentinel</option>--> To be added later
    </select>

    <button id="btn-next" class="btn next">Next</button>

    <div class="parts-container" id="parts-container" style="display: none;">
        <select id="wings"></select>
        <select id="engines"></select>
        <select id="dorsal"></select>
        <select id="cockpit"></select>
        <select id="noses"></select>
        <select id="subwings"></select>
    </div>





    <div class="container1" id="colorcontainer1" style="display: none;">
        <div class="text">Primary Colour</div>
        <div class="grid">
            <!-- First Row -->
            <div class="square" style="background-color: rgb(222, 103, 103);"></div>
            <div class="square" style="background-color: rgb(255, 133, 0);"></div>
            <div class="square" style="background-color: rgb(244, 169, 14);"></div>
            <div class="square" style="background-color: rgb(111, 169, 115);"></div>
            <div class="square" style="background-color: rgb(116, 201, 186);"></div>
            <div class="square" style="background-color: rgb(59, 143, 220);"></div>
            <div class="square" style="background-color: rgb(173, 134, 207);"></div>
            <div class="square" style="background-color: rgb(229, 132, 194);"></div>
            <div class="square" style="background-color: rgb(225, 243, 133);"></div>
            <div class="square" style="background-color: rgb(255, 255, 255);"></div>
            <!-- Second Row (Darker Colors) -->
            <div class="square" style="background-color: rgb(127, 57, 57);"></div>
            <div class="square" style="background-color: rgb(138, 94, 71);"></div>
            <div class="square" style="background-color: rgb(192, 157, 112);"></div>
            <div class="square" style="background-color: rgb(82, 112, 86);"></div>
            <div class="square" style="background-color: rgb(62, 111, 112);"></div>
            <div class="square" style="background-color: rgb(59, 74, 103);"></div>
            <div class="square" style="background-color: rgb(94, 71, 112);"></div>
            <div class="square" style="background-color: rgb(143, 85, 108);"></div>
            <div class="square" style="background-color: rgb(255, 242, 24);"></div>
            <div class="square" style="background-color: rgb(170, 170, 170);"></div>
        </div>
    </div>

    <!-- Secondary Colour -->
    <div class="container2" id="colorcontainer2" style="display: none;">
        <div class="text">Secondary Colour</div>
        <div class="grid">
            <!-- First Row -->
            <div class="square" style="background-color: rgb(222, 103, 103);"></div>
            <div class="square" style="background-color: rgb(255, 133, 0);"></div>
            <div class="square" style="background-color: rgb(244, 169, 14);"></div>
            <div class="square" style="background-color: rgb(111, 169, 115);"></div>
            <div class="square" style="background-color: rgb(116, 201, 186);"></div>
            <div class="square" style="background-color: rgb(59, 143, 220);"></div>
            <div class="square" style="background-color: rgb(173, 134, 207);"></div>
            <div class="square" style="background-color: rgb(229, 132, 194);"></div>
            <div class="square" style="background-color: rgb(225, 243, 133);"></div>
            <div class="square" style="background-color: rgb(255, 255, 255);"></div>
            <!-- Second Row (Darker Colors) -->
            <div class="square" style="background-color: rgb(127, 57, 57);"></div>
            <div class="square" style="background-color: rgb(138, 94, 71);"></div>
            <div class="square" style="background-color: rgb(192, 157, 112);"></div>
            <div class="square" style="background-color: rgb(82, 112, 86);"></div>
            <div class="square" style="background-color: rgb(62, 111, 112);"></div>
            <div class="square" style="background-color: rgb(59, 74, 103);"></div>
            <div class="square" style="background-color: rgb(94, 71, 112);"></div>
            <div class="square" style="background-color: rgb(143, 85, 108);"></div>
            <div class="square" style="background-color: rgb(255, 242, 24);"></div>
            <div class="square" style="background-color: rgb(170, 170, 170);"></div>
        </div>
    </div>

    <!-- Accent Colour -->
    <div class="container3" id="colorcontainer3" style="display: none;">
        <div class="text">Accent Colour</div>
        <div class="grid">
            <!-- First Row -->
            <div class="square" style="background-color: rgb(222, 103, 103);"></div>
            <div class="square" style="background-color: rgb(255, 133, 0);"></div>
            <div class="square" style="background-color: rgb(244, 169, 14);"></div>
            <div class="square" style="background-color: rgb(111, 169, 115);"></div>
            <div class="square" style="background-color: rgb(116, 201, 186);"></div>
            <div class="square" style="background-color: rgb(59, 143, 220);"></div>
            <div class="square" style="background-color: rgb(173, 134, 207);"></div>
            <div class="square" style="background-color: rgb(229, 132, 194);"></div>
            <div class="square" style="background-color: rgb(225, 243, 133);"></div>
            <div class="square" style="background-color: rgb(255, 255, 255);"></div>
            <!-- Second Row (Darker Colors) -->
            <div class="square" style="background-color: rgb(127, 57, 57);"></div>
            <div class="square" style="background-color: rgb(138, 94, 71);"></div>
            <div class="square" style="background-color: rgb(192, 157, 112);"></div>
            <div class="square" style="background-color: rgb(82, 112, 86);"></div>
            <div class="square" style="background-color: rgb(62, 111, 112);"></div>
            <div class="square" style="background-color: rgb(59, 74, 103);"></div>
            <div class="square" style="background-color: rgb(94, 71, 112);"></div>
            <div class="square" style="background-color: rgb(143, 85, 108);"></div>
            <div class="square" style="background-color: rgb(255, 242, 24);"></div>
            <div class="square" style="background-color: rgb(170, 170, 170);"></div>
        </div>
    </div>

    <!-- Add this container to display selected parts -->
    <div id="selected-parts" class="selected-parts">
        <p id="selected-wing">Selected Wing: </p>
        <p id="selected-engine">Selected Engine: </p>
        <p id="selected-dorsal">Selected Dorsal: </p>
        <p id="selected-cockpit">Selected Cockpit: </p>
        <p id="selected-nose">Selected Nose: </p>
        <p id="selected-subwing">Selected Subwing: </p>
        
    </div>





    <script type="module">
        let currentStep = 0;
        let selectedCode = "";
        let fighterParts = {};
        let partValues = {};
        import { dictionary } from './js/dictionary.js';

        async function loadShipData(shipType) {
            try {
                const module = await import(`./js/${shipType}.js`);
                fighterParts = module.fighterParts;
                partValues = module.partValues;
                populateDropdowns();
            } catch (error) {
                console.error("Error loading ship data:", error);
            }
        }

        function updateImage() {
            selectedCode = "";

            const selectedWing = document.getElementById("wings").value;
            const selectedCockpit = document.getElementById("cockpit").value;

            if (document.getElementById("noses").style.display === "block") {
                selectedCode += partValues[document.getElementById("noses").value];
            }

            selectedCode += partValues[document.getElementById("cockpit").value];
            selectedCode += partValues[document.getElementById("engines").value];
            selectedCode += partValues[document.getElementById("wings").value];
            if (document.getElementById("subwings").style.display === "block") {
                selectedCode += partValues[document.getElementById("subwings").value];
            }

            selectedCode += partValues[document.getElementById("dorsal").value];
            selectedCode = selectedCode.replace(/\s+/g, "");

            let imgElement = document.querySelector(".FighterParts");
            imgElement.src = `images/FighterParts/${selectedCode}.png`;

            //document.querySelector(".toptext").textContent = selectedCode;
        }

        function handleWingsChange() {
            const wingsSelect = document.getElementById("wings");
            const subwings = document.getElementById("subwings");

            const selectedWing = wingsSelect.options[wingsSelect.selectedIndex].text;

            if (fighterParts.subwings[selectedWing]) {
                subwings.innerHTML = "";
                fighterParts.subwings[selectedWing].forEach(option => {
                    const optionElement = document.createElement("option");
                    optionElement.value = option.toLowerCase().replace(/\s+/g, "-");
                    optionElement.textContent = option;
                    subwings.appendChild(optionElement);
                });

                if (fighterParts.subwings[selectedWing].includes("Bowie")) {
                    subwings.value = "bowie";
                }

                subwings.style.display = "block";
            } else {
                subwings.style.display = "none";
            }
        }

        function handleCockpitChange() {
            const cockpitSelect = document.getElementById("cockpit");
            const noses = document.getElementById("noses");

            const selectedCockpit = cockpitSelect.options[cockpitSelect.selectedIndex].text;

            if (fighterParts.noses[selectedCockpit]) {
                noses.innerHTML = "";
                fighterParts.noses[selectedCockpit].forEach(option => {
                    const optionElement = document.createElement("option");
                    optionElement.value = option.toLowerCase().replace(/\s+/g, "-");
                    optionElement.textContent = option;
                    noses.appendChild(optionElement);
                });

                if (fighterParts.noses[selectedCockpit].includes("Nose Alpha")) {
                    noses.value = "nose-alpha";
                }

                noses.style.display = "block";
            } else {
                noses.style.display = "none";
                noses.value = "";
            }
            updateImage();
        }

        function populateDropdowns() {
            for (const [part, options] of Object.entries(fighterParts)) {
                if (part === "subwings" || part === "noses") continue;

                const selectElement = document.getElementById(part);
                if (selectElement) {
                    selectElement.innerHTML = "";
                    options.forEach(option => {
                        const optionElement = document.createElement("option");
                        optionElement.value = option.toLowerCase().replace(/\s+/g, "-");
                        optionElement.textContent = option;
                        selectElement.appendChild(optionElement);
                    });
                }
            }

            document.getElementById("wings").value = "wings-vector";
            document.getElementById("engines").value = "engine-triple";
            document.getElementById("dorsal").value = "dorsal";
            document.getElementById("cockpit").value = "cockpit-multi";
            document.getElementById("noses").value = "nose-alpha";

            handleWingsChange();
            handleCockpitChange();
            updateImage();
            document.getElementById("noses").style.display = "none";
        }

        document.querySelectorAll("#parts-container select").forEach(select => {
            select.addEventListener("change", updateImage);
        });

        document.getElementById("wings").addEventListener("change", function () {
            handleWingsChange();
            updateImage();
        });

        document.getElementById("cockpit").addEventListener("change", function () {
            handleCockpitChange();
            updateImage();
        });

        document.querySelector(".btn.next").addEventListener("click", function () {
            if (currentStep === 0) {
                document.querySelector(".toptext").textContent = "Select ship parts";
                document.querySelector(".shiptype").style.display = "none";
                document.getElementById("parts-container").style.display = "flex";
                document.getElementById("engines").value = "engine-triple";
                document.getElementById("wings").value = "wings-multi";

                const wingsSelect = document.getElementById("wings");
                if (wingsSelect.options.length > 0) {
                    wingsSelect.selectedIndex = 0;
                }
                populateDropdowns();
                handleWingsChange();
                handleCockpitChange();
                updateImage();
                currentStep = 1;

            } else if (currentStep === 1) {


                // Proceed to step 2 if all colors are selected
                document.getElementById("parts-container").style.display = "none";
                document.getElementById("colorcontainer1").style.display = "block";
                document.getElementById("colorcontainer2").style.display = "block";
                document.getElementById("colorcontainer3").style.display = "block";
                document.querySelector(".toptext").textContent = "This right now does nothing just choose randomly";
                currentStep = 2;

            } else if (currentStep === 2) {
                // Check if all three color containers have a selected color
                const colorContainers = ["colorcontainer1", "colorcontainer2", "colorcontainer3"];
                let allColorsSelected = true;

                colorContainers.forEach(containerId => {
                    const container = document.getElementById(containerId);
                    const selectedSquare = container.querySelector(".square.selected");
                    if (!selectedSquare) {
                        allColorsSelected = false;
                    }
                });

                if (!allColorsSelected) {
                    alert("Please select colors in all containers.");
                    return; // Stop further execution
                }
                // Show the selected parts container
                document.getElementById("selected-parts").style.display = "block";
                document.getElementById("colorcontainer1").style.display = "none";
                document.getElementById("colorcontainer2").style.display = "none";
                document.getElementById("colorcontainer3").style.display = "none";
                document.querySelector(".toptext").style.display = "none";
                document.getElementById("btn-next").style.display = "none";


                // Get the selected wing and engine
                const selectedWing = document.getElementById("wings").value;
                const selectedEngine = document.getElementById("engines").value;
                const selectedDorsal = document.getElementById("dorsal").value;
                const selectedCockpit = document.getElementById("cockpit").value;
                const selectedNose = document.getElementById("noses").value;
                const selectedSubwing = document.getElementById("subwings").value;

                // Translate the selected parts using the dictionary
                const translatedWing = dictionary[selectedWing] || "Unknown";
                const translatedEngine = dictionary[selectedEngine] || "Unknown";
                const translatedDorsal = dictionary[selectedDorsal] || "Unknown";
                const translatedCockpit = dictionary[selectedCockpit] || "Unknown";
                const translatedNose = dictionary[selectedNose] || "Unknown";
                const translatedSubwing = dictionary[selectedSubwing] || "Unknown";

                // Function to update text or hide it if unknown
                function updatePartText(elementId, translatedValue) {
                    const element = document.getElementById(elementId);
                    if (translatedValue === "Unknown") {
                        element.style.display = "none"; // Hide the element if the part is unknown
                    } else {
                        element.style.display = "block"; // Show the element if the part is known
                        element.textContent = `${elementId.replace("selected-", "").replace("-", " ").toUpperCase()}: ${translatedValue}`;
                    }
                }

                // Update the text or hide the elements
                updatePartText("selected-wing", translatedWing);
                updatePartText("selected-engine", translatedEngine);
                updatePartText("selected-dorsal", translatedDorsal);
                updatePartText("selected-cockpit", translatedCockpit);
                updatePartText("selected-nose", translatedNose);
                updatePartText("selected-subwing", translatedSubwing);

                // Get selected colors
                const selectedColors = [];
                document.querySelectorAll(".grid").forEach(container => {
                    const selectedSquare = container.querySelector(".square.selected");
                    if (selectedSquare) {
                        const rgbValue = window.getComputedStyle(selectedSquare).backgroundColor;
                        selectedColors.push(rgbValue);
                    }
                });
            }
        });

        document.getElementById("type").addEventListener("change", function () {
            const shipType = this.value;
            loadShipData(shipType);
        });

        // Load default ship data (Fighter) on page load
        loadShipData("FIGHTER");
    </script>

    <script>
        // Add event listeners to all color containers
        document.querySelectorAll('.grid').forEach(container => {
            container.addEventListener('click', function (event) {
                // Check if the clicked element is a square
                if (event.target.classList.contains('square')) {
                    // Remove the "selected" class from all squares in this container
                    container.querySelectorAll('.square').forEach(square => {
                        square.classList.remove('selected');
                    });

                    // Add the "selected" class to the clicked square
                    event.target.classList.add('selected');
                }
            });
        });
    </script>
</body>

</html>